import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="Manual/Design tokens" />

# Design Tokens - Usage Guide

> Single source of truth for colors, typography, spacing, component states, and themes.

---

## Table of contents

1. [What's in this package?](#whats-in-this-package)
2. [Core principles](#core-principles)
3. [Quick start](#quick-start)
4. [Using tokens in CSS](#using-tokens-in-css)
5. [How tokens relate: base → theme → component](#how-tokens-relate-base--theme--component)
6. [Component tokens in practice](#component-tokens-in-practice)
7. [Typography, spacing, motion, assets](#typography-spacing-motion-assets)
8. [Theming & modes (light/dark)](#theming--modes-lightdark)
   - [Scheme-based themes](#scheme-based-themes)
   - [Attribute-driven mode control](#attribute-driven-mode-control)

9. [Theme tokens quick guide (what to define)](#theme-tokens-quick-guide-what-to-define)
10. [Authoring tokens](#authoring-tokens)
11. [Naming & structure conventions](#naming--structure-conventions)
12. [Recipes](#recipes)
13. [FAQ](#faq)
14. [Checklist before shipping a component](#checklist-before-shipping-a-component)
15. [Appendix: example token lookups](#appendix-example-token-lookups)

---

## What's in this package?

```
.
├── compiled
│   ├── fonts.css                # @font-face declarations generated from tokens/base/assets.json
│   ├── vars.css                 # All base + component tokens as CSS Custom Properties
│   └── themes/
│       ├── blue-suede-shoes.css # Theme-specific CSS variables (semantic colors)
│       └── purple-rain.css
└── tokens
    ├── base/                    # Global, brand-agnostic primitives (typography, sizes, animation, assets)
    ├── components/              # Per-component semantic tokens (button, badge, datagrid, …)
    └── themes/                  # Theme JSON files with color semantics + a color-scheme identifier
```

---

## Core principles

1. **Never reference theme variables directly** in component CSS. Only use **component** tokens (preferred) or **base** tokens.
2. **Component CSS references its own component tokens**; components are theme-agnostic.
3. **All theme usage happens in token JSON**. Themes map brand/intents to values; components only consume variables.

---

## Quick start

### Install & import (order matters)

```tsx
/* 1) Base styling (fonts + all tokens) */
import "@maykin-ui/admin-ui/style";

/* 2) Pick exactly one theme */
import "@maykin-ui/admin-ui/style/themes/blue-suede-shoes.css";
// or
import "@maykin-ui/admin-ui/style/themes/purple-rain.css";
```

> Replace the import path with your package scope if different.

---

## Using tokens in CSS

All tokens are exposed as CSS Custom Properties under `:root` (or the active mode wrapper). Names mirror the kebab-cased JSON path.

- `button.primary.default.background` → `--button-primary-default-background`
- `typography.font.size.h1` → `--typography-font-size-h1`
- `sizes.spacing.s.h` → `--sizes-spacing-s-h`

```css
.button {
  background: var(--button-primary-default-background);
  color: var(--button-primary-default-text);
  border-color: var(--button-primary-default-border);
  box-shadow: 0 1px 0 var(--button-primary-default-shadow);
}

.card__title {
  font-family: var(--typography-font-family-h);
  font-size: var(--typography-font-size-h2);
  line-height: var(--typography-line-height-h2);
}
```

---

## How tokens relate: base → theme → component

- **Base**: primitives (typography, spacing, motion). Stable across themes.
- **Theme**: semantic colors for brand & intents (success/warning/info/danger) plus base surfaces/foregrounds.
- **Component**: stateful tokens (default/hover/pressed/disabled) that reference theme semantics, not raw hex.

Change the theme once → components update automatically.

---

## Component tokens in practice

Component CSS only reads its component tokens:

```css
/* button.css */
.button {
  transition: var(--animation-duration-medium) var(--animation-timing-function);
}
.button--primary {
  background: var(--button-primary-default-background);
  color: var(--button-primary-default-text);
}
.button--primary:hover {
  background: var(--button-primary-hover-background);
}
.button--primary:active {
  background: var(--button-primary-pressed-background);
}
.button--disabled {
  background: var(--button-primary-disabled-background);
  color: var(--button-primary-disabled-text);
}
```

---

## Typography, spacing, motion, assets

Use **base** tokens for layout/typography/motion; prefer **component** tokens inside components.

```css
.page {
  padding: var(--sizes-spacing-m-v) var(--sizes-spacing-m-h);
}

h1 {
  font-family: var(--typography-font-family-h);
  font-weight: var(--typography-font-weight-heading);
  font-size: var(--typography-font-size-h1);
  line-height: var(--typography-line-height-h1);
}
```

---

## Theming & modes (light/dark)

### Scheme-based themes

Each theme JSON includes a **top-level identifier**:

```jsonc
{
  "theme": {
    "color-scheme": "light" | "dark",
    "brand": { /* … */ },
    "base": { /* … */ },
    "intent": { /* … */ }
  }
}
```

**Build output rules**:

- If a theme is **light**, its variables are emitted under `:root` in `compiled/themes/<name>.css`.
- If a theme is **dark**, its variables are emitted under `:root[data-mode="dark"]`, **plus** a system-dark fallback block so dark applies when no explicit mode is set:

```css
/* dark theme file */
:root[data-mode="dark"] {
  /* variables for dark theme */
}
@media (prefers-color-scheme: dark) {
  :root:not([data-mode]) {
    /* same variables to follow OS setting */
  }
}
```

> The `color-scheme` value is **metadata** used by the build to choose wrappers. It is **not** emitted as a CSS variable or property.

### Attribute-driven mode control

Consumers control mode via an attribute:

```html
<html data-mode="light">
  …
</html>
<!-- force light -->
<html data-mode="dark">
  …
</html>
<!-- force dark  -->
```

If the attribute is **absent**, dark themes will follow the user’s OS setting through the `prefers-color-scheme` fallback in the theme CSS.

---

## Theme tokens quick guide (what to define)

> For authors creating or tweaking **themes** under `tokens/themes/`.

### Structure

```jsonc
{
  "theme": {
    "color-scheme": "light", // or "dark"
    "brand": {
      "primary": {
        "default": { "value": "#2078C5" },
        "hover": { "value": "#2573B2" },
        "pressed": { "value": "#1A5C94" },
        "active": { "value": "#2078C5" },
        "contrast": { "value": "#FFFFFF" },
      },
      "secondary": {
        /* same states */
      },
      "accent": {
        /* same states */
      },
    },
    "base": {
      "background": { "value": "#FFFFFF" },
      "background-alternate": { "value": "#EDEDED" },
      "foreground": { "value": "#333333" },
      "foreground-muted": { "value": "#595959" },
      "foreground-disabled": { "value": "#767676" },
      "border": { "value": "#949494" },
      "shadow": { "value": "rgba(0,0,0,.10)" },
      "link": { "value": "#331A81" },
    },
    "intent": {
      "success": {
        /* default/hover/pressed/active/contrast */
      },
      "warning": {
        /* … */
      },
      "danger": {
        /* … */
      },
      "info": {
        /* … */
      },
    },
  },
}
```

Create two separate theme files if you need both a light **and** a dark variant of a brand. The build will wrap each correctly based on its `color-scheme`.

---

## Authoring tokens

### Add a new component token file

1. Create `tokens/components/<component>.json`.
2. Define stateful properties referencing **theme** and **base** tokens.
3. Rebuild to regenerate `compiled/vars.css`.
4. Update your component CSS to consume the new variables.

```jsonc
// tokens/components/toggle.json (example)
{
  "toggle": {
    "on": {
      "background": { "value": "{theme.brand.accent.default}" },
      "thumb": { "value": "{theme.base.background}" },
    },
    "off": {
      "background": { "value": "{theme.base.background-alternate}" },
      "thumb": { "value": "{theme.base.foreground}" },
    },
  },
}
```

### Add or modify a theme

1. Create `tokens/themes/<theme>.json` with `color-scheme`, `brand`, `base`, and `intent` groups.
2. Rebuild to get `compiled/themes/<theme>.css`.
3. Import that CSS to apply.

---

## Naming & structure conventions

- **Kebab-case CSS vars** mirror the **dot-path** in JSON: `a.b.c` → `--a-b-c`.
- Component tokens are **stateful** (e.g., `default`, `hover`, `pressed`, `disabled`).
- Theme tokens are **semantic**: `brand.primary`, `intent.success`, `base.foreground`.
- Prefer **indirection**: component → theme/base; never component → hex.

---

## Recipes

### Build a new component CSS using tokens

```css
/* chip.css */
.chip {
  display: inline-flex;
  gap: var(--sizes-spacing-xs-h);
  border-radius: var(--sizes-border-radius-s);
  padding: var(--sizes-spacing-xs-v) var(--sizes-spacing-s-h);
  font: var(--typography-font-weight-normal)
    var(--typography-font-size-body-s) / var(--typography-line-height-body-s)
    var(--typography-font-family-body);
  background: var(--chip-default-background);
  color: var(--chip-default-text);
  border: 1px solid var(--chip-default-border);
}
.chip--success {
  background: var(--chip-success-background);
  color: var(--chip-success-text);
}
```

### React + CSS file

```tsx
// DangerLink.tsx
import React from "react";

import "./danger-link.css";

export function DangerLink({ children }: { children: React.ReactNode }) {
  return <a className="link link--danger">{children}</a>;
}
```

```css
/* danger-link.css */
.link {
  text-decoration: underline;
}
.link--danger {
  color: var(--badge-danger-text);
}
```

> This example consumes a **component** token from `compiled/vars.css`.

---

## FAQ

**Can I import only the tokens I need?**
`compiled/vars.css` is already small; import once at app root.

**Can I read theme vars directly in CSS?**
No. Use **component** or **base** tokens. Theme vars are an implementation detail.

**How do I add fonts?**
Add to `tokens/base/assets.json`, rebuild.

**How do I support dark mode now?**
Create a separate **dark** theme file with `"color-scheme": "dark"`. Consumers can force mode with `data-mode="dark"|"light"`; if absent, dark themes respect `prefers-color-scheme`.

---

## Checklist before shipping a component

- [ ] All colors come from **component tokens** (no raw hex).
- [ ] Typography uses **typography** base tokens.
- [ ] Spacing/radii use **sizes** base tokens.
- [ ] Motion uses **animation** base tokens.
- [ ] No CSS imports a **theme** var directly.
- [ ] States (hover/pressed/disabled) are defined in tokens.
- [ ] Works in both a **light** and a **dark** theme file.

---

## Appendix: example token lookups

- Button primary default background → `--button-primary-default-background`
- Badge outline border → `--badge-outline-border`
- Typography body text color → `--typography-color-body`
- Container max width → `--sizes-container-max`
- Animation medium duration → `--animation-duration-medium`
