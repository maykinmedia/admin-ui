import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="Manual/Design tokens" />

# Design Tokens - Usage Guide

> Single source of truth for colors, typography, spacing, component states, and themes.

---

## Table of contents

1. [What's in this package?](#whats-in-this-package)
2. [Core principles](#core-principles)
3. [Quick start](#quick-start)
4. [Using tokens in CSS](#using-tokens-in-css)
5. [How tokens relate: base → theme → component](#how-tokens-relate-base--theme--component)
6. [Component tokens in practice](#component-tokens-in-practice)
7. [Typography, spacing, motion, assets](#typography-spacing-motion-assets)
8. [Theming & modes (light/dark)](#theming--modes-lightdark)

   * [Attribute-driven dark mode](#attribute-driven-dark-mode)
   * [Roadmap: Theme API & persistence](#roadmap-theme-api--persistence)
9. [Authoring tokens](#authoring-tokens)
10. [Naming & structure conventions](#naming--structure-conventions)
11. [Recipes](#recipes)
12. [FAQ](#faq)
13. [Checklist before shipping a component](#checklist-before-shipping-a-component)
14. [Appendix: example token lookups](#appendix-example-token-lookups)

---

## What's in this package?

```
.
├── compiled
│   ├── fonts.css                # @font-face declarations generated from tokens/assets.json
│   ├── vars.css                 # All base + component tokens as CSS Custom Properties
│   └── themes/
│       ├── blue-suede-shoes.css # Theme-specific CSS variables (semantic colors)
│       └── purple-rain.css
└── tokens
    ├── base/                    # Global, brand-agnostic primitives (typography, sizes, animation, assets)
    ├── components/              # Per-component semantic tokens (button, badge, datagrid, …)
    └── themes/                  # Brand palettes + intents per theme (base/bg, brand, intent, …)
```

---

## Core principles

1. **Never reference a theme variable directly** in `.css` files. Only use **component** tokens or **base** tokens.
2. **Component CSS references its own component tokens** (preferred) or base tokens (typography, sizes, animation).
3. **All theme usage happens in tokens** (JSON), not in component CSS. Components don't know which theme they're on; they just read their own token values.
4. **Dark mode is variable-driven**. Don't branch component CSS on media queries — tokens+variables handle it.

---

## Quick start

### Install & import (order matters)

```tsx
// 1) Base styling (fonts + all tokens)
import "@your-scope/admin-ui/style";

// 2) Pick ONE theme
import "@your-scope/admin-ui/themes/blue-suede-shoes";
```

> Replace `@your-scope/admin-ui` with this package name in your registry.

---

## Using tokens in CSS

All tokens are exposed as CSS Custom Properties under `:root`. Names follow the kebab-cased JSON path.

* `button.primary.default.background` → `--button-primary-default-background`
* `typography.font.size.h1` → `--typography-font-size-h1`
* `sizes.spacing.s.h` → `--sizes-spacing-s-h`

```css
.button {
  background: var(--button-primary-default-background);
  color: var(--button-primary-default-text);
  border-color: var(--button-primary-default-border);
  box-shadow: 0 1px 0 var(--button-primary-default-shadow);
}

.card__title {
  font-family: var(--typography-font-family-h);
  font-size: var(--typography-font-size-h2);
  line-height: var(--typography-line-height-h2);
}
```

---

## How tokens relate: base → theme → component

* **Base**: universal primitives (typography colors, font families, spacing, motion). Stable across themes.
* **Theme**: semantic colors for brand and intents (success/warning/info/danger) plus base surfaces/foregrounds.
* **Component**: stateful tokens (default/hover/pressed/disabled) that map to theme semantics, not raw hex.

This lets you:

* Change *brand primary* once → all **button.primary** states update automatically.
* Adjust type scale once → all components inheriting typography tokens update.

---

## Component tokens in practice

**Buttons** define all states as component tokens, referencing theme + base. A primary button doesn't hardcode a hex; it uses `theme.brand.primary.*` and `typography.*` through component tokens. CSS reads **only** `--button-…` variables.

```css
/* button.css — only reads component token vars */
.button { transition: var(--animation-duration-medium) var(--animation-timing-function); }
.button--primary        { background: var(--button-primary-default-background); color: var(--button-primary-default-text); }
.button--primary:hover  { background: var(--button-primary-hover-background); }
.button--primary:active { background: var(--button-primary-pressed-background); }
.button--disabled       { background: var(--button-primary-disabled-background); color: var(--button-primary-disabled-text); }
```

**Badges** follow the same pattern.

---

## Typography, spacing, motion, assets

* **Typography**: fonts, sizes, weights, line-heights, and neutral text colors.
* **Sizes**: spacing scale, container widths, radii.
* **Animation**: timing functions + duration scale.
* **Assets**: font files and formats; `compiled/fonts.css` is generated from here.

Use them directly in CSS when building layouts, but prefer **component tokens** inside component styles.

```css
.page { max-width: var(--sizes-container-max); padding: var(--sizes-spacing-m-v) var(--sizes-spacing-m-h); }

h1 { font-family: var(--typography-font-family-h); font-weight: var(--typography-font-weight-heading); font-size: var(--typography-font-size-h1); line-height: var(--typography-line-height-h1); color: var(--typography-color-h); }

a { color: var(--typography-color-link); }
small { font-size: var(--typography-font-size-body-xs); }
```

---

## Theming & modes (light/dark)

### Attribute-driven dark mode

Tokens can specify an optional `dark` override. Example:

```jsonc
{
  "theme": {
    "brand": {
      "primary": {
        "default": { "value": "#341A90", "dark": "#8B82FF" }
      }
    }
  }
}
```

The build emits three rule blocks **only for tokens that include `dark`**:

```css
:root {                         /* default (light) */
  --theme-brand-primary-default: #341A90;
}
:root[data-mode="dark"] {      /* explicit attribute */
  --theme-brand-primary-default: #8B82FF;
}
@media (prefers-color-scheme: dark) {
  :root:not([data-mode]) {      /* follow system when attribute absent */
    --theme-brand-primary-default: #8B82FF;
  }
}
```

**Usage options**

1. **Follow system**: omit the attribute; users get OS preference via `prefers-color-scheme`.
2. **Force a mode**: set `data-mode="light" | "dark"` on `<html>` or any container to scope it.

```html
<html lang="en" data-mode="dark"> <!-- force dark globally -->
<section class="preview" data-mode="light"> <!-- light for a subtree -->
```

### Roadmap: Theme API & persistence

A friendly runtime API will expose helpers to switch and remember the mode:

```ts
import { getMode, setMode, onModeChange } from "@your-scope/admin-ui/theme";

setMode("dark");   // persist + set attribute
setMode(null);      // remove attribute, follow system
const current = getMode();
const off = onModeChange(cb);
```

* `setMode("light" | "dark")` → sets `data-mode` (default scope: `<html>`), persists choice, notifies listeners.
* `setMode(null)` → clears persistence + attribute; falls back to system.
* `getMode()` → effective persisted choice or `null`.

---

## Authoring tokens

### Add a new component token file

1. Create `tokens/components/<component>.json`.
2. Define stateful properties referencing theme/base tokens (use `dark` where needed).
3. Rebuild to regenerate `compiled/vars.css`.
4. Update your component CSS to consume the new variables.

```jsonc
// tokens/components/toggle.json (example)
{
  "toggle": {
    "on": {
      "background": { "value": "{theme.brand.accent.default}", "dark": "{theme.brand.accent.default}" },
      "thumb":      { "value": "{theme.base.background}", "dark": "{theme.base.background}" }
    },
    "off": {
      "background": { "value": "{theme.base.background-alternate}", "dark": "{theme.base.background-alternate}" },
      "thumb":      { "value": "{theme.base.foreground}", "dark": "{theme.base.foreground}" }
    }
  }
}
```

### Add or modify a theme

1. Create `tokens/themes/<theme>.json` with `brand`, `base`, and `intent` groups.
2. Rebuild to get `compiled/themes/<theme>.css`.
3. Import that CSS to apply.

### Expand base primitives

Add to `tokens/base/` to grow your design language (e.g., new spacing sizes). Components will pick them up once you wire them into component tokens.

---

## Naming & structure conventions

* **Kebab-case CSS vars** mirror the **dot-path** in JSON: `a.b.c` → `--a-b-c`.
* Component tokens are **stateful** (e.g., `default`, `hover`, `pressed`, `disabled`).
* Theme tokens are **semantic**: `brand.primary`, `intent.success`, `base.foreground`.
* Prefer **indirection**: component → theme/base; never component → hex.

---

## Recipes

### Build a new component CSS using tokens

```css
/* chip.css */
.chip {
  display: inline-flex;
  gap: var(--sizes-spacing-xs-h);
  border-radius: var(--sizes-border-radius-s);
  padding: var(--sizes-spacing-xs-v) var(--sizes-spacing-s-h);
  font: var(--typography-font-weight-normal) var(--typography-font-size-body-s)/var(--typography-line-height-body-s) var(--typography-font-family-body);
  background: var(--chip-default-background);
  color: var(--chip-default-text);
  border: 1px solid var(--chip-default-border);
}
.chip--success { background: var(--chip-success-background); color: var(--chip-success-text); }
```

### React + CSS file

```tsx
// DangerLink.tsx
import React from "react";
import "./danger-link.css";

export function DangerLink({ children }: { children: React.ReactNode }) {
  return <a className="link link--danger">{children}</a>;
}
```

```css
/* danger-link.css */
.link { text-decoration: underline; }
.link--danger { color: var(--badge-danger-text); }
```

> This example consumes a **component** token (badge danger text) from `compiled/vars.css`.

---

## FAQ

**Can I import only the tokens I need?**
`compiled/vars.css` is already small and tree-shaking CSS variables is non-trivial. Import once at app root.

**Can I read theme vars directly in CSS?**
No. Reference **component** or **base** tokens. Theme vars are an implementation detail of tokens → components mapping.

**How do I add fonts?**
Add to `tokens/base/assets.json`, rebuild, and import `compiled/fonts.css`.

**How do I support dark mode now?**
Provide `dark` overrides where needed. Consumers can force mode with `data-mode="dark"|"light"`; if absent, we respect `prefers-color-scheme`. The attribute wins over the media query.

---

## Checklist before shipping a component

* [ ] All colors come from **component tokens**, not raw hex.
* [ ] Typography uses **typography** base tokens.
* [ ] Spacing/radii use **sizes** base tokens.
* [ ] Motion uses **animation** base tokens.
* [ ] No CSS imports a **theme** var directly.
* [ ] States (hover/pressed/disabled) are defined in tokens.

---

## Appendix: example token lookups

* Button primary default background → `--button-primary-default-background`
* Badge outline border → `--badge-outline-border`
* Typography body text color → `--typography-color-body`
* Container max width → `--sizes-container-max`
* Animation medium duration → `--animation-duration-medium`

Keep building with tokens—your UI stays consistent while themes remain swappable and accessible in both light and dark modes.
